<!DOCTYPE html>
<html lang="ru">
<head>
  <title>HTML article</title>
</head>
<body>
  <h1>
    Как отлаживать <b>bash-script-ы</b> по шагам или, возможно, самая короткая статья о программировании/отладке на Хабре
  </h1>
  <hr />
  <small>*nix*</small>

  <h2>Введение</h2>
  <p>Мне всегда хотелось иметь возможность отлаживать <b>bash-scripts</b> так же, как и любой другой код, т.е. по шагам, и <b>bash</b> такую возможность предусмотрел, но о ней не все знают. Несмотря на довольно большой опыт использования Linux, я дошёл до неё только недавно.</p>

  <h2>Волшебная строчка, которую нужно добавить после #!/bin/bash, чтоб скрипт можно было отлаживать по шагам</h2>
  <blockquote>
    <p>
      <strong>#!/bin/bash</strong>
    </p>
    <p>
      <strong>trap 'echo "# $BASH_COMMAND";read' DEBUG</strong>
    </p>
    <p>
      <strong>echo line1</strong>
      <br />
      <strong>echo line2</strong>
    </p>
    <p>
      <strong>echo line3</strong>
    </p>
  </blockquote> 

  <h2>Процесс отладки</h2>
  <p>
    Запускаем скрипт, перед выполнением каждой команды выводится то, что будет исполняться, затем интерпретатор начинает ожидать нажатия клавиши <b>ENTER</b>.

    Если понимаем, что что-то пошло не так, нажимаем <b>Ctrl+C</b> и выходим из отладки.
  </p>

  <h2>Ингредиенты</h2>
  <ul>
    <li>
      команда <b>trap</b>, которая умеет перехватывать разные сигналы и в нашем случае она перехватывает сигнал <b>DEBUG</b>, посылаемый перед выполнением команды
    </li>
    <li>
      команда <b>read</b>, которая умеет ожидать ввода чего-нибудь с клавиатуры (в данном случае нам нужно только либо <b>ENTER</b> либо <b>Ctrl+C</b>
    </li>
      переменная окружения <b>$BASH_COMMAND</b>, валидная внутри обработчика команды <b>trap</b>.
    </li>
  </ul>

  <h2>Пример</h2>
  <a href="https://onlinegdb.com/1h1BpiINv">https://onlinegdb.com/1h1BpiINv</a>
  <p>
    Теги: <i>bash</i>, bash-скрипт, bash-программирование, debug, bash-script, ingone-linersone-liner, <s>javascript</s>, <s>css</s>
  </p>
  <a href="https://habr.com/ru/post/666982/">Ссылка</a> на статью
</body>
</html>